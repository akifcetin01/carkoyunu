<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Åžans Ã‡arkÄ±</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{margin:0;padding:0;box-sizing:border-box}
body{
  background:#020617;
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  font-family:system-ui;
  color:white;
}
.container{
  width:min(460px,95vw);
  padding:20px;
  border-radius:20px;
  background:rgba(15,23,42,.9);
  backdrop-filter:blur(10px);
  text-align:center
}
.wheel-box{
  position:relative;
  width:min(340px,80vw);
  aspect-ratio:1/1;
  margin:10px auto;
}
canvas{
  width:100%;
  height:100%;
  border-radius:50%
}

/*** OK YUKARIDA VE Ã‡ARKA BAKIYOR ***/
.indicator{
  position:absolute;
  top:-10px;
  left:50%;
  transform:translateX(-50%);
  width:0;height:0;
  border-left:14px solid transparent;
  border-right:14px solid transparent;
  border-top:26px solid #facc15;
  filter:drop-shadow(0 0 6px rgba(0,0,0,.8))
}

.spin{
  position:absolute;
  left:50%;top:50%;
  transform:translate(-50%,-50%);
  width:36%;
  aspect-ratio:1/1;
  border-radius:50%;
  border:none;
  background:radial-gradient(circle,#ffd43b,#facc15,#b45309);
  font-weight:800;
  letter-spacing:.05em;
  cursor:pointer;
}
.spin.disabled{opacity:.4;pointer-events:none}

.overlay,.popup{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.85);
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:99
}
.hidden{display:none}
.box{
  background:#020617;
  padding:20px;
  border-radius:16px;
  border:1px solid #5c677d;
  text-align:center
}
button{
  padding:10px 20px;
  border-radius:20px;
  border:none;
  font-weight:700;
  cursor:pointer
}
.ok{background:#22c55e;color:white}
.gold{background:#facc15;color:black}
</style>
</head>

<body>

<div class="container">
  <h2>ÅžANS Ã‡ARKI</h2>
  <p>Ã‡evir ve Ã¶dÃ¼lÃ¼nÃ¼ yakala!</p>

  <div class="wheel-box">
    <div class="indicator"></div>
    <canvas id="wheel" width="400" height="400"></canvas>
    <button id="spin" class="spin">Ã‡EVÄ°R</button>
  </div>

  <p style="opacity:.7;font-size:.9rem">
    Bol Åžanslar ðŸŽ‰
  </p>
</div>

<!-- PAS Overlay -->
<div id="retry" class="overlay hidden">
  <div class="box">
    <h3>PAS geldi</h3>
    <p>ÅžansÄ±nÄ± bir kez daha dene!</p>
    <button id="retryBtn" class="ok">Tekrar Dene</button>
  </div>
</div>

<!-- KazanÃ§ Popup -->
<div id="win" class="popup hidden">
  <div class="box">
    <h2 style="background:linear-gradient(orange,yellow);-webkit-background-clip:text;color:transparent">
      Tebrikler KazandÄ±nÄ±z!
    </h2>
    <p>BÃœYÃœK KAZANÃ‡ Ã¶dÃ¼lÃ¼nÃ¼ aldÄ±nÄ±z ðŸŽ‰</p>
    <button id="cont" class="gold">Devam Et</button>
  </div>
</div>

<script>
const canvas = document.getElementById("wheel");
const ctx = canvas.getContext("2d");
const btn = document.getElementById("spin");
const retry = document.getElementById("retry");
const retryBtn = document.getElementById("retryBtn");
const win = document.getElementById("win");
const cont = document.getElementById("cont");

const segments = [
 "50 FS","50 TL","PAS","100 TL",
 "50 FS","50 TL","PAS","100 TL",
 "50 FS","50 TL","PAS","100 TL",
 "BÃœYÃœK\nKAZANÃ‡"
];

const colors=[
 "#f43f5e","#3b82f6","#22c55e","#f59e0b",
 "#e879f9","#38bdf8","#4ade80","#f97316",
 "#ec4899","#6366f1","#10b981","#fb923c",
 "#fbbf24"
];

let rotation=0;
let spinning=false;
let step=(Math.PI*2)/segments.length;

function draw(){
  ctx.clearRect(0,0,400,400);
  ctx.save();
  ctx.translate(200,200);
  ctx.rotate(rotation);

  for(let i=0;i<segments.length;i++){
    let start=i*step;
    let end=start+step;

    ctx.beginPath();
    ctx.moveTo(0,0);
    ctx.arc(0,0,180,start,end);
    ctx.fillStyle=colors[i%colors.length];
    ctx.fill();
    ctx.strokeStyle="#0f172a";
    ctx.lineWidth=2;
    ctx.stroke();

    ctx.save();
    ctx.rotate(start+step/2);
    ctx.translate(120,0);
    ctx.rotate(Math.PI/2);
    ctx.fillStyle="white";
    ctx.font="bold 15px system-ui";
    ctx.textAlign="center";

    let text=segments[i].split("\n");
    text.forEach((t,j)=>{
      ctx.fillText(t,0,(j-(text.length-1)/2)*16);
    });

    ctx.restore();
  }
  ctx.restore();
}
draw();

let state="idle";

/*
  POINTER ÃœSTTE (12 YÃ–NÃœ, AÃ‡I = -Ï€/2)
  â†’ R + (index*step + step/2) = -Ï€/2
  â†’ R = -Ï€/2 - (index*step + step/2)  (mod 2Ï€)
*/
function spinTo(index,after){
  let spins = 3 + Math.floor(Math.random()*2); // 3â€“4 tur
  const mid = index*step + step/2;
  const desired = -Math.PI/2 - mid;      // bu dilim tam oka gelsin
  let target = spins*2*Math.PI + desired;

  let start=rotation;
  let change=target-start;
  let dur=4000;
  let t0=performance.now();
  spinning=true;
  btn.classList.add("disabled");

  function animate(t){
    let p=Math.min((t-t0)/dur,1);
    let e=1-Math.pow(1-p,3);
    rotation=start+change*e;
    draw();
    if(p<1){
      requestAnimationFrame(animate);
    }else{
      spinning=false;
      btn.classList.remove("disabled");
      after();
    }
  }
  requestAnimationFrame(animate);
}

// 1. SPIN â†’ PAS
btn.onclick=()=>{
  if(spinning) return;
  if(state!=="idle") return;

  let pasIndex=segments.indexOf("PAS");
  spinTo(pasIndex,()=>{
    state="pasDone";
    retry.classList.remove("hidden");
  });
};

// 2. SPIN â†’ BÃœYÃœK KAZANÃ‡
retryBtn.onclick=()=>{
  retry.classList.add("hidden");
  let bigIndex=segments.findIndex(s=>s.includes("BÃœYÃœK"));
  spinTo(bigIndex,()=>{
    state="done";
    btn.classList.add("disabled");
    win.classList.remove("hidden");
  });
};

cont.onclick=()=>window.location.href="https://t.me/Consp01";
</script>

</body>
</html>
